<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juander | Shuttle Service Ride Application </title>
    <link rel="icon" type="image/x-icon" href="./images/icons/juander-icon.ico">
    <link href="index.css" rel="stylesheet" type="text/css" />
    <link href="index.mobile.css" rel="stylesheet" type="text/css" />
    <!-- FONTAWESOME-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- BOOTSTRAP-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/css/bootstrap.min.css" integrity="sha512-GQGU0fMMi238uA+a/bdWJfpUGKUkBdgfFdgBm72SUQ6BeyWjoY/ton0tEjH+OSH9iP4Dfh+7HM0I9f5eR0L/4w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/js/bootstrap.bundle.min.js" integrity="sha512-pax4MlgXjHEPfCwcJLQhigY7+N8rt6bVvWLFyUMuxShv170X53TRzGPmPkZmGBhk+jikR8WBM4yl7A9WMHHqvg==" crossorigin="anonymous" referrerpolicy="no-referrer" defer></script>
    <!-- TOM SELECT -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tom-select/2.0.3/css/tom-select.min.css" integrity="sha512-HZ7LD8/WlBbdwTrhR7B+tpXfuD21i53SQbzDYeQLKpftG7qfsKKOoSVlm582hTHd5d/R1/qvpqiW6/grsJ6xrQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tom-select/2.0.3/js/tom-select.complete.min.js" integrity="sha512-2qmAnESluBTM3Skcvwk8IXwjA972fMyM8DDJziBS0Jca9FRtswisyZjT/3d9iAnaqIwYx6dFE9B//hKrYOrFWQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- CLEAVE JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cleave.js/1.6.0/cleave.min.js" integrity="sha512-KaIyHb30iXTXfGyI9cyKFUIRSSuekJt6/vqXtyQKhQP6ozZEGY8nOtRS6fExqE4+RbYHus2yGyYg1BrqxzV6YA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- SWAL 2-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/11.4.8/sweetalert2.min.css" integrity="sha512-y4S4cBeErz9ykN3iwUC4kmP/Ca+zd8n8FDzlVbq5Nr73gn1VBXZhpriQ7avR+8fQLpyq4izWm0b8s6q4Vedb9w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/11.4.8/sweetalert2.min.js" integrity="sha512-7x7HoEikRZhV0FAORWP+hrUzl75JW/uLHBbg2kHnPdFmScpIeHY0ieUVSacjusrKrlA/RsA2tDOBvisFmKc3xw==" crossorigin="anonymous" referrerpolicy="no-referrer" defer></script>
    <!-- QR code JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js" integrity="sha512-CNgIRecGo7nphbeZ04Sc13ka07paqdeTu0WR1IM4kNcpmBAUSHSQX0FslNhTDadL4O5SAGapGt4FodqL8My0mA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
    <div class="container-fluid d-flex flex-column" style="min-height: 100vh;">
        <div class="row p-2 main-top-navbar" id="main_top_navbar">
            <div class="col"></div>
            <div class="col-6 d-flex my-auto justify-content-center">
                <span class="h3" style="color: #0066A3; margin-bottom: 0;">Juander</span>
            </div>
            <div class="col"></div>
        </div>
        <div class="row p-2 secondary-top-navbar" id="secondary_top_navbar" style="display: none;">
            <div class="col d-flex justify-content-start">
                <button type="button" class="btn btn-primary-outline" id="back_to_previous_page_button" style="color: #373737;">
                    <i class="fa-solid fa-arrow-left-long"></i>
                </button>
            </div>
            <div class="col-6 d-flex my-auto justify-content-center">
                <span class="h4" style="color: #0066A3; margin-bottom: 0;">Juander</span>
            </div>
            <div class="col"></div>
        </div>
        <div class="row" style="flex-grow: 1;">
            <div class="container user-account-container tab-page-active" id="user_account_container">
                <div class="user-account-main-page" id="user_account_main_page">
                    <div class="container">
                        <div class="row user-account-header pt-5 pb-5" style="background-color: #C0CED8;">
                            <div class="col-12 col-sm col-md-4 d-flex justify-content-center align-items-center mb-3 mb-sm-0">
                                <div id="qr_code_image"></div>
                            </div>
                            <div class="col-12 col-sm d-flex flex-column justify-content-center align-items-center align-items-sm-start">
                                <div class="user-summary-details" id="user_summary_detail">
                                    <h4>John Smith</h4>
                                    <p class="text-muted">Software Engineer</p>
                                    <span class="badge rounded-pill bg-primary">Information Technology</span>
                                </div>
                            </div> 
                        </div>
                        <div class="row user-account-body p-4 d-flex flex-column justify-content-center">
                            <div class="col mt-2 mb-2 d-flex flex-column justify-content-center text-center">
                                <h5 class="mb-2">Things you can do</h5>
                                <button type="button" class="btn btn-primary mb-2 m-auto col-9 col-sm-6 col-md-4 col-lg-3" id="set_carpool_ride_info_button">Set Ride Info</button>
                            </div>
                            <div class="col mt-2 mb-2 d-flex flex-column justify-content-center text-center">
                                <h5 class="mb-2">Your account</h5>
                                <button type="button" class="btn btn-primary mb-2 m-auto col-9 col-sm-6 col-md-4 col-lg-3" id="settings_button">Settings</button>
                                <button type="button" class="btn btn-primary mb-2 m-auto col-9 col-sm-6 col-md-4 col-lg-3" id="sign_out_button">Sign out</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="share-carpool-ride-page" id="set_carpool_ride_info_page" style="display: none;">
                    <div class="container p-3 pt-5 pb-5">
                        <div class="carpool-ride-info-header pb-4 row">
                            <div class="col-12 col-md-6">
                                <h2 class="m-0">Carpool Ride</h2>
                                <p class="text-muted">Set or update your carpool ride information</p>
                            </div>
                            <div class="col-12 col-md-6 d-flex justify-content-md-end align-items-center">
                                <button type="submit" class="btn btn-primary" id="carpool_ride_info_save_button">Save</button>      
                            </div>                      
                        </div>
                        <form class="row g-3">
                            <div class="border p-4">
                                <div class="row g-3">
                                    <div class="col">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="is_carpool_driver">
                                            <label class="form-check-label" for="is_carpool_driver">Set as Carpool Driver</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="border p-4">
                                <h4  class="float-none w-auto mb-3">Vehicle Details</h4>
                                <div class="row g-3">
                                    <div class="col-md-4">
                                        <label for="plate_no" class="form-label">Plate No.</label>
                                        <input autocomplete="off" type="text" class="form-control" id="plate_no">
                                    </div>
                                    <div class="col-md-4">
                                        <label for="vehicle_brand" class="form-label">Brand</label>
                                        <input autocomplete="off" type="text" class="form-control" id="vehicle_brand">
                                    </div>
                                    <div class="col-md-4">
                                        <label for="vehicle_model" class="form-label">Model</label>
                                        <input autocomplete="off" type="text" class="form-control" id="vehicle_model">
                                    </div>
                                    <div class="col-md-4">
                                        <label for="vehicle_color" class="form-label">Color</label>
                                        <input autocomplete="off" type="text" class="form-control" id="vehicle_color">
                                    </div>
                                    <div class="col-md-4">
                                        <label for="available_seats" class="form-label">No. of Seats</label>
                                        <input autocomplete="off" type="number" min="0" max="30" class="form-control" id="available_seats">
                                    </div>
                                    <div class="col-md-4">
                                        <label for="vehicle_type" class="form-label">Type</label>
                                        <select id="vehicle_type" class="form-control" name="vehicle_type">
                                            <option value="sedan">Sedan</option>
                                            <option value="suv">SUV</option>
                                            <option value="van">Van</option>
                                            <option value="motorcycle">Motorcycle</option>
                                            <option value="others">Others</option>
                                        </select>
                                    </div>
                                </div>
                             </div>
                             <div class="border p-4">
                                <h4  class="float-none w-auto mb-3">Contact Details</h4>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="driver_email" class="form-label">Email</label>
                                        <input autocomplete="off" type="email" class="form-control" id="driver_email">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="driver_contact_no" class="form-label">Contact No.</label>
                                        <input autocomplete="off" type="text" class="form-control" id="driver_contact_no" placeholder="09xx xxx xxxx" title="format: 09xx xxx xxxx">
                                    </div>
                                </div>
                             </div>
                        </form>
                    </div>
                </div>
                <div class="settings-page" id="settings_page" style="display: none;">
                    <div class="container p-3 pt-5 pb-5">
                        <div class="settings-header pb-4 row">
                            <div class="col-12 col-md-6">
                                <h2 class="m-0">Settings</h2>
                                <p class="text-muted">Update your user Information</p>
                            </div>
                            <div class="col-12 col-md-6 d-flex justify-content-md-end align-items-center">
                                <button type="submit" class="btn btn-primary">Save</button>      
                            </div>
                        </div>
                        <form class="row g-3">
                            <div class="border p-4">
                                <h4  class="float-none w-auto mb-3">My Profile</h4>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="employee_id" class="form-label">Employee ID</label>
                                        <input autocomplete="off" type="text" class="form-control" id="employee_id" readonly>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="employee_name" class="form-label">Full Name</label>
                                        <input autocomplete="off" type="text" class="form-control" id="employee_name">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="department" class="form-label">Department</label>
                                        <input autocomplete="off" type="text" class="form-control" id="department">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="job_role" class="form-label">Job Role</label>
                                        <input autocomplete="off" type="text" class="form-control" id="job_role">
                                    </div>
                                </div>
                             </div>
                             <div class="border p-4">
                                <h4  class="float-none w-auto mb-3">Carpool Details</h4>
                                <div class="row g-3">
                                    <div class="col-md-4">
                                        <label for="location" class="form-label">Location</label>
                                        <input autocomplete="off" type="text" class="form-control" id="location">
                                    </div>
                                    <div class="col-md-4">
                                        <label for="pick_up_point" class="form-label">Pick-up point</label>
                                        <input autocomplete="off" type="text" class="form-control" id="pick_up_point">
                                    </div>
                                    <div class="col-md-4">
                                        <label for="drop_off_point" class="form-label">Drop-off point</label>
                                        <input autocomplete="off" type="text" class="form-control" id="drop_off_point">
                                    </div>
                                    <div class="col-md-4">
                                        <label for="contact_no" class="form-label">Contact No.</label>
                                        <input autocomplete="off" type="text" class="form-control" id="contact_no" placeholder="09xx xxx xxxx" title="format: 09xx xxx xxxx">
                                    </div>
                                    <div class="col-md-4">
                                        <label for="onsite_schedule" class="form-label">Onsite Schedule</label>
                                        <select id="onsite_schedule" class="form-control" name="onsite_schedule">
                                            <option value="a" selected>Two days in a week</option>
                                            <option value="b">Two consecutive weeks</option>
                                            <option value="c">Daily every other week</option>
                                            <option value="d">Daily</option>
                                            <option value="e">Others</option>
                                        </select>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="onsite_days" class="form-label">Onsite Days</label>
                                        <select id="onsite_days" class="form-control" name="onsite_days[]" multiple>
                                            <option value="mon">Monday</option>
                                            <option value="tues">Tuesday</option>
                                            <option value="wed">Wednesday</option>
                                            <option value="thurs">Thursday</option>
                                            <option value="fri">Friday</option>
                                        </select>
                                    </div>
                                </div>
                             </div>
                             <div class="border p-4">
                                <h4  class="float-none w-auto mb-3">Account Details</h4>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="email" class="form-label">Email</label>
                                        <input autocomplete="off" type="email" class="form-control" id="email">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="password" class="form-label">Password</label>
                                        <input autocomplete="off" type="password" class="form-control" id="password">
                                    </div>
                                </div>
                             </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="row main-bottom-navbar" id="main_bottom_navbar">
            <div class="col" style="background-color: #FFFFFF; border-top: 1px solid #C0CED8;">
                <div class="container">
                    <div class="row">
                        <a class="col text-center p-3 d-flex flex-column carpool-tab-button" id="carpool_tab_button" href="./carpool.html">
                            <i class="fa-solid fa-car-side"></i>Carpool
                        </a>
                        <a class="col text-center p-3 d-flex flex-column shuttle-tab-button" id="shuttle_tab_button" href="./shuttle.html">
                            <i class="fa-solid fa-van-shuttle"></i>Shuttle
                        </a>
                        <a class="col text-center p-3 d-flex flex-column user-account-tab-button tab-active" id="user_account_tab_button" href="./account.html">
                            <i class="fa-solid fa-user"></i>Account
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="./data.js"></script>
    <script type="text/javascript">
        var main_top_navbar = document.getElementById('main_top_navbar');
        var secondary_top_navbar = document.getElementById('secondary_top_navbar');
        var main_bottom_navbar = document.getElementById('main_bottom_navbar');
        var back_to_previous_page_button = document.getElementById('back_to_previous_page_button');

        var qr_code_image = document.getElementById('qr_code_image');
        var set_carpool_ride_info_button = document.getElementById('set_carpool_ride_info_button');
        var settings_button = document.getElementById('settings_button');
        var sign_out_button = document.getElementById('sign_out_button');

        var user_account_main_page = document.getElementById('user_account_main_page');
        var set_carpool_ride_info_page = document.getElementById('set_carpool_ride_info_page');
        var settings_page = document.getElementById('settings_page');

        var inputEmployeeId = document.getElementById('employee_id');
        var inputFullName = document.getElementById('employee_name');
        var inputDepartment = document.getElementById('department');
        var inputJobRole = document.getElementById('job_role');
        var inputLocation = document.getElementById('location');
        var inputContactNo = document.getElementById('contact_no');
        var inputPickupPoint = document.getElementById('pick_up_point');
        var inputDropOffPoint = document.getElementById('drop_off_point');
        var selectOnsiteSchedule = document.getElementById('onsite_schedule');
        var selectOnsiteDays = document.getElementById('onsite_days');
        var inputEmail = document.getElementById('email');
        var inputPassword = document.getElementById('password');
        var buttonSaveCarpoolRide = document.getElementById('carpool_ride_info_save_button');
        var inputPlateNumber = document.getElementById('plate_no');
        var inputVehicleBrand = document.getElementById('vehicle_brand');
        var inputVehicleModel = document.getElementById('vehicle_model');
        var inputVehicleColor = document.getElementById('vehicle_color');
        var inputAvailableSeats = document.getElementById('available_seats');
        var selectVehicleType = document.getElementById('vehicle_type');
        var inputDriverEmail = document.getElementById('driver_email');
        var inputDriverContactNo = document.getElementById('driver_contact_no');

        var switchIsCarpoolDriver = document.getElementById('is_carpool_driver');

        function generateUserQRCode(data) {
            qr_code_image.innerHTML = '';

            var qrcode = new QRCode(qr_code_image, {
                width: 180,
                height: 180
            });

            var output = data.account.access_role === 'd' ? data._id + '_' + data.vehicle_id + '_' + data.account.access_role : data._id + '_' + data.account.access_role;

            qrcode.makeCode(JSON.stringify(output, null, 2));

            var vehicleDetails = data.account.access_role === 'd' ? '\nVehicle ID: ' + data.vehicle_id + '\nPlateNumber: ' + data.vehicle_plate_number : '';
            qr_code_image.title = '';
        }

        function loadUserData () {
            var currentUser = users[1];

            document.getElementById('user_summary_detail').innerHTML = '<h4 class=\"m-0\">' + currentUser.name + '</h4>'
                                                                        + '<p class=\"text-muted\">' + currentUser.job_role + '</p>'
                                                                        + '<span class=\"badge rounded-pill bg-primary\">' + currentUser.department + '</span>';
            generateUserQRCode(currentUser);
        }
        function loadUserDataToModify() {
            var currentUser = users[1];
            var currentOnsiteDays = currentUser.carpool.onsite_days.split(',');

            inputEmployeeId.value = currentUser.employee_id;
            inputFullName.value = currentUser.name;
            inputDepartment.value = currentUser.department;
            inputJobRole.value = currentUser.job_role;
            inputLocation.value = currentUser.carpool.location;
            inputContactNo.value = currentUser.carpool.contact_no;
            inputPickupPoint.value = currentUser.carpool.pick_up_point;
            inputDropOffPoint.value = currentUser.carpool.drop_off_point;
            selectOnsiteSchedule.value = currentUser.carpool.onsite_schedule;

            new TomSelect(selectOnsiteDays,{
                maxItems: 5,
                valueField: 'id',
                create: false,
                plugins: {
                    checkbox_options: {},
                    change_listener: {},
                    input_autogrow: {},
                    remove_button: {
                        title:'Remove this item',
                    }
                },
                items: currentOnsiteDays,
                persist: false,
            });

            new Cleave(inputContactNo, {
                numericOnly: true,
                blocks: [0, 4, 3, 4],
                delimiters: ["", " ", " "]
            });

            inputEmail.value = currentUser.account.email;
            inputPassword.value = currentUser.account.password;
        }

        function toggleCarpoolDriverForm () {
            new Cleave(inputDriverContactNo, {
                numericOnly: true,
                blocks: [0, 4, 3, 4],
                delimiters: ["", " ", " "]
            });

            if (switchIsCarpoolDriver.checked) {
                inputPlateNumber.disabled = false;
                inputVehicleBrand.disabled = false;
                inputVehicleModel.disabled = false;
                inputVehicleColor.disabled = false;
                inputAvailableSeats.disabled = false;
                selectVehicleType.disabled = false;
                inputDriverEmail.disabled = false;
                inputDriverContactNo.disabled = false;
                buttonSaveCarpoolRide.disabled = false;
            } else {
                inputPlateNumber.disabled = true;
                inputVehicleBrand.disabled = true;
                inputVehicleModel.disabled = true;
                inputVehicleColor.disabled = true;
                inputAvailableSeats.disabled = true;
                selectVehicleType.disabled = true;
                inputDriverEmail.disabled = true;
                inputDriverContactNo.disabled = true;
                buttonSaveCarpoolRide.disabled = true;
            }
        }
        function showMainTopNavbar () {
            main_top_navbar.style.display = 'flex';
            secondary_top_navbar.style.display = 'none';
            main_bottom_navbar.style.display = 'block';
        }
        function showSecondaryTopNavbar () {
            main_top_navbar.style.display = 'none';
            secondary_top_navbar.style.display = 'flex';
            main_bottom_navbar.style.display = 'none';
        }
        function showMainPage () {
            user_account_main_page.style.display = 'block';
            set_carpool_ride_info_page.style.display = 'none';
            settings_page.style.display = 'none';
        }
        function showSetCarpoolRidePage () {
            set_carpool_ride_info_page.style.display = 'block';
            settings_page.style.display = 'none';
            user_account_main_page.style.display = 'none';
        }
        function showSettingsPage () {
            settings_page.style.display = 'block';
            set_carpool_ride_info_page.style.display = 'none';
            user_account_main_page.style.display = 'none';
        }

        function onMainPage () {
            showMainPage();
            showMainTopNavbar();
            loadUserData();
        }
        function onSetCarpoolRidePage () {
            showSetCarpoolRidePage();
            showSecondaryTopNavbar();
            toggleCarpoolDriverForm();
            
        }
        function onSettingsPage () {
            showSettingsPage();
            showSecondaryTopNavbar();
            loadUserDataToModify();
        }

        back_to_previous_page_button.addEventListener('click', onMainPage);
        set_carpool_ride_info_button.addEventListener('click', onSetCarpoolRidePage);
        settings_button.addEventListener('click', onSettingsPage);
        switchIsCarpoolDriver.addEventListener('change', toggleCarpoolDriverForm);

        document.addEventListener('DOMContentLoaded', function () {
            onMainPage();
        });
    </script>
</body>
</html>